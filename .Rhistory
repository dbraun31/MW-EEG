title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank())
## Histogram of r values ##
subs %>%
ggplot(aes(x = r)) +
geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x, y = density, fill = percentile, group=percentile)) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank())
## Histogram of r values ##
subs %>%
ggplot(aes(x = r)) +
geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x, y = density, fill = percentile, group=percentile)) +
#  geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank())
theoretical
theoretical %>%
ggplot(aes(x = x, y = density)) +
geom_line() +
geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile))
theoretical %>%
ggplot(aes(x = x, y = density, group = percentile)) +
geom_line() +
geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile))
theoretical %>%
ggplot(aes(x = x, y = density, group = percentile)) +
geom_line() +
geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile), alpha = .6)
theoretical %>%
ggplot(aes(x = x, y = density, group = percentile)) +
#  geom_line() +
geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile), alpha = .6)
theoretical
theoretical <- data.frame(x = seq(-1, 1, .001), density = dnorm(seq(-1, 1, .001), .024, .369))
theoretical$cumsum <- cumsum(theoretical$density *.001)
theoretical$percentile <- ifelse(theoretical$cumsum > .16 & theoretical$cumsum < .84, 'middle', 'outside')
theoretical %>%
ggplot(aes(x = x, y = density, group = percentile)) +
#  geom_line() +
geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile), alpha = .6)
View(theoretical)
View(theoretical)
theoretical %>%
ggplot(aes(x = x, y = density, group = percentile)) +
geom_line() +
#  geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile), alpha = .6)
## Histogram of r values ##
subs %>%
ggplot(aes(x = r)) +
geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x, fill = percentile, group=percentile)) +
#  geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank())
theoretical %>%
ggplot(aes(x = x, y = density, group = percentile)) +
geom_line()
theoretical %>%
ggplot(aes(x = x, y = density)) +
geom_line()
theoretical %>%
ggplot(aes(x = x, y = density, fill = percentile)) +
geom_line() +
geom_area()
theoretical %>%
ggplot(aes(x = x, y = density, fill = percentile)) +
geom_area(alpha=.2)
theoretical %>%
ggplot(aes(x = x, y = density, fill = percentile)) +
geom_area(alpha=.2) +
geom_line(size = 3) +
#  geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile), alpha = .6)
## Histogram of r values ##
subs %>%
ggplot(aes(x = r)) +
geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x, fill = percentile, group=percentile)) +
#  geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank())
theoretical %>%
ggplot(aes(x = x, y = density, fill = percentile)) +
geom_area(alpha=.2) +
geom_line(size = 3)
#  geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile), alpha = .6)
## Histogram of r values ##
subs %>%
ggplot(aes(x = r)) +
geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x, fill = percentile, group=percentile)) +
#  geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank())
#  geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile), alpha = .6)
## Histogram of r values ##
subs %>%
ggplot(aes(x = r)) +
#  geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
#  geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x, fill = percentile, group=percentile)) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank())
#  geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile), alpha = .6)
## Histogram of r values ##
subs %>%
ggplot(aes(x = r)) +
#  geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
#  geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x, fill = percentile, group=percentile)) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
text = element_text(size = 14))
path <- paste0('scripts/descriptives/aaron_report/session_correlation_histogram_', group, '.png')
ggsave(path, height = 12, width = 12, units='in', dpi = 100)
#  geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile), alpha = .6)
## Histogram of r values ##
subs %>%
ggplot(aes(x = r)) +
#  geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
#  geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x, fill = percentile, group=percentile)) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
text = element_text(size = 20))
path <- paste0('scripts/descriptives/aaron_report/session_correlation_histogram_', group, '.png')
ggsave(path, height = 12, width = 12, units='in', dpi = 100)
#  geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile), alpha = .6)
## Histogram of r values ##
subs %>%
ggplot(aes(x = r)) +
#  geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
#  geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x, fill = percentile, group=percentile)) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0, size = 16) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
text = element_text(size = 20))
path <- paste0('scripts/descriptives/aaron_report/session_correlation_histogram_', group, '.png')
ggsave(path, height = 12, width = 12, units='in', dpi = 100)
#  geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile), alpha = .6)
## Histogram of r values ##
subs %>%
ggplot(aes(x = r)) +
#  geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
#  geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x, fill = percentile, group=percentile)) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0, size = 10) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
text = element_text(size = 20))
path <- paste0('scripts/descriptives/aaron_report/session_correlation_histogram_', group, '.png')
ggsave(path, height = 12, width = 12, units='in', dpi = 100)
#  geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile), alpha = .6)
## Histogram of r values ##
subs %>%
ggplot(aes(x = r)) +
#  geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
#  geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x, fill = percentile, group=percentile)) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0, size = 6) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
text = element_text(size = 20))
path <- paste0('scripts/descriptives/aaron_report/session_correlation_histogram_', group, '.png')
ggsave(path, height = 12, width = 12, units='in', dpi = 100)
#  geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile), alpha = .6)
## Histogram of r values ##
subs %>%
ggplot(aes(x = r)) +
#  geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
#  geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x, fill = percentile, group=percentile)) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0, size = 6) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
text = element_text(size = 25))
path <- paste0('scripts/descriptives/aaron_report/session_correlation_histogram_', group, '.png')
ggsave(path, height = 12, width = 12, units='in', dpi = 100)
#  geom_ribbon(aes(ymin = 0, ymax = density, fill = percentile), alpha = .6)
## Histogram of r values ##
subs %>%
ggplot(aes(x = r)) +
geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
#  geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x, fill = percentile, group=percentile)) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0, size = 6) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
text = element_text(size = 25))
path <- paste0('scripts/descriptives/aaron_report/session_correlation_histogram_normal_', group, '.png')
ggsave(path, height = 12, width = 12, units='in', dpi = 100)
rm(list = ls())
library(tidyverse)
group <- 'eeg'
#group <- 'fmri-eeg'
if (group == 'eeg') {
path <- "data/behavioral_data/MW_EEG_behavioral_full.csv"
} else if (group == 'fmri-eeg') {
path <- 'scripts/descriptives/aaron_report/fmri-eeg_data/pilot.csv'
}
d <- read.csv(path)
if (group == 'eeg') {
# Drop subjects with < 40 trials
N_start <- length(unique(d$subject))
keep <- d %>%
group_by(subject) %>%
summarize(count = n()) %>%
filter(count >= 40) %>%
pull(subject)
d <- d[d$subject %in% keep,]
print(paste0('Dropping ', N_start - length(unique(d$subject)), ' of ', N_start, ' subjects for < 40 trials'))
}
# Keep only relevant columns
d <- select(d, subject, run, arou_response, arou_onset)
# Number of subjects
N <- length(unique(d$subject))
# Missing arousal responses
print(sum(is.na(d$arou_response)) / nrow(d))
print(d[is.na(d$arou_response), ])
d <- d[!is.na(d$arou_response),]
# Make subject-level summaries
subject_summary <- d %>%
group_by(subject) %>%
summarize(trial_count = n(),
arousal_mean = round(mean(arou_response), 2),
arousal_sd = round(sd(arou_response), 2)) %>%
select(subject,trial_count, arousal_mean, arousal_sd)
# Visualize arousal distribution
d %>%
group_by(subject) %>%
summarize(arou = mean(arou_response)) %>%
ggplot(aes(x = arou)) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8) +
xlim(0, 100) +
labs(
x = 'Mean Arousal Rating',
y = 'Frequency',
caption = 'Averaged across subjects'
) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank())
path <- paste0('scripts/descriptives/aaron_report/arousal_distribution_', group, '.png')
ggsave(path, height = 800, width = 800, units='px', dpi = 100)
# Look at arousal trends over session
# Compute trial counters
d <- d %>%
group_by(subject) %>%
mutate(trial_session = 1:n()) %>%
ungroup() %>%
select(subject, run, trial_session, arou_onset, arou_response)
## CORRELATE ACROSS SESSION ##
library(scales)
cols <- c('black',
brewer_pal(palette='Blues')(9)[7],
brewer_pal(palette='Blues')(9)[5],
brewer_pal(palette='Blues')(9)[3])
sig_levels = c('N.S.', 'p < .05', 'p < .01', 'p < .001')
subs <- d %>%
group_by(subject) %>%
summarize(r = round(cor(trial_session, arou_response), 3),
p = round(cor.test(trial_session, arou_response)$p.value, 3),
ci_h = round(cor.test(trial_session, arou_response)$conf.int[2], 3),
ci_l = round(cor.test(trial_session, arou_response)$conf.int[1], 3)) %>%
mutate(issig = ifelse(p < .001, 'p < .001',
ifelse(p < .01, 'p < .01',
ifelse(p < .05, 'p < .05', 'N.S.')))) %>%
mutate(issig = factor(issig, levels = sig_levels))
grand <- subs %>%
summarize(r_mean = round(mean(r), 3), r_se = sd(r) / sqrt(N)) %>%
mutate(ci_h = round(1.94 * r_se, 3), ci_l = round(-1.94 * r_se, 3))
subs %>%
ggplot(aes(x = reorder(subject, r), y = r)) +
geom_hline(yintercept=0, linetype='dotted') +
geom_point(aes(color=issig)) +
geom_errorbar(aes(ymin = ci_l, ymax = ci_h, color = issig, linetype=issig), width = 0) +
labs(
title= 'Session-level correlation between time in session and arousal',
x = 'Subject',
y = 'Correlation (r)',
linetype = '',
color = '',
caption = 'Horizontal lines reflect 95% CIs'
) +
coord_flip() +
annotate('text', x = 26, y = -.8, label = paste0('Overall:\nMean r: ',
grand$r_mean, '\nCIs: [', grand$ci_l, ', ',
grand$ci_h, ']'), hjust=0) +
scale_color_manual(values = c('N.S.'=cols[1], 'p < .05'=cols[2], 'p < .01'=cols[3], 'p < .001'=cols[4])) +
ylim(-1, 1) +
theme_bw() +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
legend.position = c(.17, .9))
path <- paste0('scripts/descriptives/aaron_report/session_correlation_', group, '.png')
ggsave(path, height = 800, width = 800, units='px', dpi = 100)
antext <- paste0('Mean: ', round(mean(subs$r), 3),
'\nSD: ', round(sd(subs$r), 3))
theoretical <- data.frame(x = seq(-1, 1, .001), density = dnorm(seq(-1, 1, .001), .024, .369))
theoretical$cumsum <- cumsum(theoretical$density *.001)
theoretical$percentile <- ifelse(theoretical$cumsum > .16 & theoretical$cumsum < .84, 'middle',
theoretical$cumsum <= .16, 'beginning', 'end')
theoretical$percentile <- ifelse(theoretical$cumsum > .16 & theoretical$cumsum < .84, 'middle',
ifelse(theoretical$cumsum <= .16, 'beginning', 'end'))
subs %>%
ggplot(aes(x = r)) +
geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x, fill = percentile, group=percentile)) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0, size = 6) +
xlim(-1, 1) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
text = element_text(size = 25))
show_col(brewer_pal()(9))
show_col(brewer_pal(palette = 'Greens')(9))
green <- brewer_pal(palette='Greens')(9)[3]
subs %>%
ggplot(aes(x = r)) +
geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x,
fill = percentile, group=percentile), show.legend = FALSE) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0, size = 6) +
xlim(-1, 1) +
scale_fill_manual(values = c('beginning'=NA, 'end' = NA, 'middle' = green)) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
text = element_text(size = 25))
subs %>%
ggplot(aes(x = r)) +
geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x,
fill = percentile, group=percentile), show.legend = FALSE) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0, size = 6) +
xlim(-1, 1) +
scale_fill_manual(values = c('beginning'=element_blank(), 'end' = NA, 'middle' = green)) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
text = element_text(size = 25))
subs %>%
ggplot(aes(x = r)) +
geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x,
fill = percentile, group=percentile), show.legend = FALSE) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0, size = 6) +
xlim(-1, 1) +
scale_fill_manual(values = c('beginning'='white', 'end' = 'white', 'middle' = green)) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
text = element_text(size = 25))
theoretical$cumsum <- pnorm(theoretical$x, .024, .369)
tail(theoretical)
theoretical$percentile <- ifelse(theoretical$cumsum > .16 & theoretical$cumsum < .84, 'middle',
ifelse(theoretical$cumsum <= .16, 'beginning', 'end'))
subs %>%
ggplot(aes(x = r)) +
geom_line(data = theoretical, aes(x = x, y = density * (7/max(density)))) +
geom_ribbon(data = theoretical, aes(ymin = 0, ymax = density * (7/max(density)), x = x,
fill = percentile, group=percentile), show.legend = FALSE) +
geom_histogram(color = 'black', fill = 'steelblue', alpha = .8, bins = 15) +
labs(
title = 'Distribution of within-session arousal correlations',
x = 'Subject-wise correlations (r)',
y = 'Frequency'
) +
annotate('text', x = .8, y = 7, label=antext, hjust=0, size = 6) +
xlim(-1, 1) +
scale_fill_manual(values = c('beginning'='white', 'end' = 'white', 'middle' = green)) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
text = element_text(size = 25))
help(density)
density
str(density)
